<?php

class Sectors_model extends CI_Model
{
    public function get_sectors($sector_id = null)
    {       
        if(isset($sector_id))
        {
            $this->db->where('sector_id', $sector_id);
        }
        $this->db->order_by('sector');
        $query = $this->db->get('sectors');
        return $query->result();
    }

    public function update_sector($sector_id, $newsector)
    {
         //make sure no duplicates are created
         $this->db->select('*');
         $this->db->from('sectors');
         $this->db->where('sector', $newsector);
         $query = $this->db->get();
         if (!$query->result()) {
             $this->db->set('sector', $newsector);
             $this->db->where('sector_id', $sector_id);
             $this->db->update('sectors');
             return true;
         } else {
             //message: sector already exists in table
             return false;
         }
    }

    public function add_sector($newsector)
    {
        //check if this exists
        $data = [
            'sector' => $newsector
        ];

        $this->db->where('sector', $newsector);
        $query = $this->db->get('sectors');

        if ($query->result()!= NULL) {
            return false;
        }

        if($this->db->insert('sectors', $data)){
            return true;
        } else {
            return false;
        }

    }
}