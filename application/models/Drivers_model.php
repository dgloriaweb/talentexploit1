<?php

class Drivers_model extends CI_Model
{
    public function get_license_types($driving_id = null)
    {
        if ($driving_id) {
            $this->db->where('driving_id', $driving_id);
        }

        $query = $this->db->get('drivers');
        return $query->result();
    }

    public function update_license($driving_id, $newlicense)
    {
        //check if new doesn't exist yet
        $this->db->select('*');
        $this->db->from('drivers');
        $this->db->where('drivers_license', $newlicense);
        $query = $this->db->get();
        if (!$query->result()) {
            $this->db->set('drivers_license', $newlicense);
            $this->db->where('driving_id', $driving_id);
            if (!$this->db->update('drivers')) {
                return false;
            } else {
                return true;
            }
        } else {
            //message: license already exists in table
            return false;
        }
    }

    public function add_license($newlicense)
    {
        //check if new doesn't exist yet
        $this->db->select('*');
        $this->db->from('drivers');
        $this->db->where('drivers_license', $newlicense);
        $query = $this->db->get();
        if (!$query->result()) {
            $data = [
                'drivers_license' => $newlicense
            ];
            if (!$this->db->insert('drivers', $data)) {
                return false;
            } else {
                return true;
            }
        } else {
            return false;
        }

    }
}
