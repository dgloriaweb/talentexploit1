<?php include 'header.php';?>
<h1>
	<p style="text-transform: capitalize;">Skill: <?= $skill_data[0]->skill?></p>
</h1>
<div>
	<?=form_open("skills/update_skill"); ?>
	<div>
		<input type="text" id="skill_input" class="form-control col-4" name="skill_input"
			value="<?= $skill_data[0]->skill ?>">
	</div>
	<input type="hidden" id="skill_id" name="skill_id" value="<?= $skill_data[0]->skill_id ?>">
	<button class="btn btn-warning">Save changes</button>
	<?=form_close();?>
</div>
<div>
	<h5>Core skill(s):</h5>
</div>

<?php foreach($skill_data as $skill) : ?>
<div>
	<a href="<?= site_url('skills/remove_core_skill_link/'.$skill_data[0]->skill_id.'/'.$skill->core_skill_id) ?>"
		class="btn btn-sm btn-secondary"><i class="fa fa-trash"></i></a>
	<?= $skill->core_skill?>
</div>
<?php endforeach ?>

<!-- add new core skill link using a modal with a dropdown -->
<button class="btn btn-primary view_detail" relid="<?= $skill_data[0]->skill_id;  ?>">Add new core skill link</button>
<a href="<?= site_url('skills') ?>" class="btn btn-secondary">Close</a>



<!-- modal -->
<div id="show_modal" class="modal fade" role="dialog" style="background: #000;">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h3> Core skills</h3>
			</div>
      <?=form_open(site_url('skills/add_core_skill_link/'.$skill_data[0]->skill_id));?>
			<div class="modal-body">
				<select class="form-control" id="core_skill_select" name="core_skill_selection">

        </select>
			</div>
			<div class="modal-footer">
        <button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i> Close</button>
				<button type="submit" class="btn btn-success">Save changes</button>
			</div>
      <?=form_close();?>
		</div>
	</div>
</div>



<!-- script for modal -->
<script type="text/javascript">
	$(document).ready(function () {

		$('.view_detail').click(function () {

			var id = $(this).attr('relid'); //get the attribute value

			$.ajax({
				url: "<?php echo base_url(); ?>skills/get_core_skills",
				data: {
					id: id
				},
				method: 'GET',
				dataType: 'json',
				success: function (response) {
					$.each(response, function (i) {
						$('#core_skill_select').append('<option value="'+response[i].core_skill_id+'"> ' + response[i].core_skill +
						'</option>'); //hold the response in id and show on popup
					});
					$('#show_modal').modal({
						backdrop: 'static',
						keyboard: true,
						show: true
					});
				}
			});
		});
	});

</script>
