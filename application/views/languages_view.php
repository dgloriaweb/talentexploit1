<?php include 'header.php';?>
<?=validation_errors();?>
<h1>Languages</h1>
<div class="col-md-12">
	<table class="table table-primary">
		<tr>
			<th></th>
			<th>Language</th>
			<th>Language level</th>
		</tr>
		<?php if ($languages): ?>
		<?php foreach ($languages as $language): ?>
		<tr>
			<td><a href="<?=base_url('persons/delete/' . $language->prop_id . '/languages')?>">
					<img src=<?=base_url("images/trash_s.png")?> class="beaicons" data-toggle="tooltip"
						data-placement="left" title="Delete">
				</a>
				<!-- TODO remove if not required -->
				<!-- <a class="update_language" relid="
				<?php //echo $language->prop_id?>
				">
				<img src=
					<?php //echo base_url("images/edit_s2.png")?>
						class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit item">
				</a> -->
			</td>
			<td><?=$language->language?>
			</td>
			<td><?=$language->language_level?></td>
		</tr>
		<?php endforeach?>
		<?php endif?>
	</table>
	<!-- add new license link using a modal with a dropdown -->
	<button class="btn btn-primary  view_detail" relid="<?=$this->session->userdata('person_id');?>">Add new
		language</button>
	<a href="<?=site_url('persons')?>" class="btn btn-secondary">Close</a>
</div>


<!-- add new modal -->
<div id="show_modal_add" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h3> Add language</h3>
			</div>
			<?=form_open('languages/add');?>

			<div class="modal-body">

				<!-- dropdown with the existing languages.language-->
				<div><label for="language_selection">Language</label>
					<select class="form-control" id="language_selection" name="language_selection">
					</select>
				</div>
				<div><label for="langlevel_selection">Language level</label>
					<select class="form-control" id="langlevel_selection" name="langlevel_selection">
					</select>
				</div>
				<div class="modal-footer">
					<button type="submit" class="btn btn-success">Save changes</button>
					<button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i>
						Close</button>
				</div>
			</div>
			<?=form_close();?>
		</div>

	</div>
</div>

<!-- script for - add new - modal -->
<script type="text/javascript">
	$(document).ready(function () {
		$('.view_detail').click(function () {
			var id = $(this).attr('relid'); //get the attribute value
			$.ajax({
				url: "<?php echo base_url(); ?>languages/get_modal_data",
				data: {
					id: id,
					id_name: 'language_id',
					type: 'language',
					table: 'languages'
				},
				type: "post",
				dataType: 'json',
				success: function (response) {
					$.each(response['languages'], function (i) {
						$('#language_selection').append('<option value="' + response[
								'languages'][i]
							.language_id + '"> ' + response['languages'][i]
							.language +
							'</option>');
					})
					$.each(response['langlevels'], function (i) {
						$('#langlevel_selection').append('<option value="' + response[
								'langlevels'][i]
							.langlevel_id + '"> ' + response['langlevels'][i]
							.language_level +
							'</option>');
					})
					$('#show_modal_add').modal({
						backdrop: 'static',
						keyboard: true,
						show: true
					});
				}
			});
		});
	});

</script>


<?php include 'footer.php';?>
