<?php include 'header.php'; ?>
<?php if (!$this->session->userdata('logged_in')) : ?>
    <?= validation_errors(); ?>

    Welcome. You are not logged in.<br />

    <!-- here we need to check if user is logged in -->
<?php else : ?>

    <h2>Your settings</h2>
    <br>
    <a href="<?= base_url('persons') ?>" class="btn btn-secondary float-right">Back</a>
    <div class="container">

        <!-- ***********************************************************  -->
        <!-- *** drivers licenses *** -->
        <!-- ***********************************************************  -->
        <h3>Drivers' Licenses</h3>
        <div class="container">
            <!-- here we need the job licenses to see if we need to show anything -->
            <!-- if we have none or we have one match and it is none. None can't go without any other selection, it's always 1-->
  
            <div class="row">
                    <div class="card card-body">
                        <?php include 'includes/edit_licenses_view.php'; ?>
                    </div>
            </div>


            <hr>
        </div>

        <!-- ***********************************************************  -->
        <!-- *** END drivers licenses *** -->
        <!-- ***********************************************************  -->


        <h3>Skills</h3>

        <!-- if no skills found -->
        <?php if (!array_key_exists('skills', $properties)) : ?>
            <div class="main_info_items">
                <img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
                <a href=<?= base_url("persons/skills/detail")?>><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
                <span class="prop-title"> Skills</span>

            </div>
        <?php endif ?>
        <hr>
        <!-- **************** Skills ******************** -->
        <?php foreach ($properties as $property => $value) : ?>
            <?php if ($property == 'skills') : ?>
                <div class="card">
                    <!-- header -->
                    <div class="prop_dropdown" data-toggle="collapse" data-target="#demo6">
                        <img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
                            Skills</span>
                    </div>
                    <!-- data grid -->
                    <div id="demo6" class="collapse hide main_info_items">
                        <div class="container">
                            <a href=<?= base_url("persons/skills/detail")?>><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
                            Details
                            <div class="container">
                                <div class="row">
                                    <div class="col">
                                        Skill description
                                    </div>
                                </div>
                                <?php foreach ($value as $items) : ?>
                                    <div class="row">
                                        <div class="col details-grid">
                                            <?= $items['skill_name'] ?>
                                        </div>
                                    </div>
                                <?php endforeach ?>
                            </div>
                        </div>
                    </div>
                    <br>
                </div>
            <?php endif ?>

            <!--  **************** Skills END ******************** -->

        <?php endforeach ?>
        <!-- END *** Show person's properties  *** -->

<br>



        <!-- ******************************************* -->
        <!-- ***        Work preferences             *** -->
        <!-- ******************************************* -->
        <h3>Your work hour and day preferences</h3>
        <br>
        <div class="accordion" id="myAccordion">
            <div class="row">
                <?php foreach ($workprefs_array as $type => $value) : ?>
                    <div class="col-12 col-md-3 workprefs">
                        <h5><?= $type ?></h5>
                        <ul class="list-group">
                            <?php foreach ($workprefs_array[$type] as $value) : ?>
                                <?php //echo '<pre>'; var_dump($value); echo '</pre>'; die;
                                ?>
                                <?php if ($work_details[$value] == 1) : ?>
                                    <?php if ($work_details[$value] == $work_details[$value]) : ?>
                                        <li class="list-group-item"><?= $value ?>
                                            <img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="right" title="Match">
                                        </li>
                                    <?php else : ?>
                                        <li class="list-group-item"><?= $value ?>
                                            <img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="right" title="No match">
                                        </li>
                                    <?php endif ?>
                                <?php else : ?>
                                    <?php if ($type == 'overtime') : ?>
                                        <li class="list-group-item">Not Required</li>
                                    <?php endif ?>

                                <?php endif ?>
                            <?php endforeach ?>
                        </ul>
                    </div>

                <?php endforeach ?>

            </div>
            <br>
            <!-- work preferences dropdown -->
            <div class="accordion" id="myAccordion">
                <div class="row">
                    <a class="btn btn-outline-info" data-toggle="collapse" href="#collapseExample" role="button" data-parent="#myAccordion" aria-expanded="false" aria-controls="collapseExample">
                        Edit your overtime and work hour preferences <i class="fa fa-caret-down"></i>
                    </a>
                </div>
                <div class="row">
                    <div class="collapse" id="collapseExample">
                        <div class="card card-body">
                            <?php include 'includes/edit_workprefs_view.php'; ?>
                        </div>
                    </div>
                </div>
                <hr>
            </div>
        </div>
        <!--  **************** Work hour preferences END ******************** -->
    </div>
    <a href="<?= base_url('persons') ?>" class="btn btn-secondary float-right">Back</a>

<?php endif ?>
</div>

<?php include 'footer.php'; ?>