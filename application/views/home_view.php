<?php include 'header.php'; ?>
<?php if (!$this->session->userdata('logged_in')) : ?>
	<?= validation_errors(); ?>

	Welcome. You are not logged in.<br />

	<!-- here we need to check if user is logged in -->
<?php else : ?>

	<!-- there are more results for a drivers license just as every other property -->
	<!-- later we need to simplify this and do only one foreach for all properties that is not null -->
	<h2>Welcome <?= $this->session->userdata('username') ?></h2>

	<!--
  Here we need to show a dashboardish style progress on the info given, and if we are able to recommend a position yet.
 -->

	<h3>Here is your status: </h3>
	<div class="progress">
		<div class="progress-bar bg-info" role="progressbar" aria-valuenow="<?= $progress ?>" aria-valuemin="0" aria-valuemax="100" style="width:<?=$progress?>%">
			<span class="sr-only"><?= $progress ?>% Complete</span>
		</div>
		<span class="progress-type">Progress </span>
		<span class="progress-completed">&nbsp;<?= $progress ?>%</span>
	</div>

	<p>
		<?php if ($jobs[0]['job_rate'] < 50) : ?>
			You haven't got a job that matches more than 90%, is it because you didn't provide enough data? Based on that I
			cannot give you recommendation for a future role. Please scroll down and fill in more data to continue.</p>
<?php else : ?>
	<div class="card">
		<h2>Recommended jobs</h2>
		<?php foreach ($jobs as $job) : ?>
			<div class="card-text">
				<a href=<?= base_url("job_user/index/" . $job['job_id']) ?>><?= $job['job_name'] ?></a>

				<span class="badge badge-success"><?= $job['job_rate'] ?>%</span>
			</div>

		<?php endforeach ?>
	</div>
<?php endif ?>

<div>
	<h4>More...<h4>
</div>
<h2>General Info</h2>
<div class="container">
	<p>
		<h3>Personal properties</h3>
		<p>
			<!-- ******************************************* -->
			<!-- ***  Main list of not found properties *** -->
			<!-- ******************************************* -->
			<!-- if no driving data found -->
			<?php if (!array_key_exists('drivers_license', $properties)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/drivers_license/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Drivers License</span>
					<p>

				</div>
			<?php endif ?>

			<!-- if no skills found -->
			<?php if (!array_key_exists('skill', $properties)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/skills/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Skills</span>
					<p>
				</div>
			<?php endif ?>

			<!-- if no languages found -->
			<?php if (!array_key_exists('language', $properties)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/languages/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Languages</span>
					<p>
				</div>
			<?php endif ?>

			<!-- if no sectors found -->
			<?php if (!array_key_exists('sector', $properties)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/sectors/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Sectors</span>
					<p>
				</div>
			<?php endif ?>

			<!-- if no citizenship found -->
			<?php if (!array_key_exists('citizenship', $properties)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/citizenships/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Citizenships</span>
					<p>
				</div>
			<?php endif ?>

			<!-- Construction will not appear here since it's not applicable for everyone -->
			<!-- END  ***  Main list of not found properties *** -->



			<!-- ********************************* -->
			<!-- *** Show person's properties  *** -->
			<!-- ********************************* -->

			<?php foreach ($properties as $property => $value) : ?>

				<!-- **************** Drivers' licenses ******************** -->
				<?php if ($property == 'drivers_license') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#demo1">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
								Drivers'
								Licenses</span>
						</div>
						<!-- data grid -->
						<div id="demo1" class="collapse hide">
							<div class="container">
								<a href="persons/drivers_license/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Drivers' license type
										</div>
										<div class="col">
											Years of experience
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['drivers_license'] ?>
											</div>
											<div class="col details-grid">
												<?= $items['driving_years'] ?>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>

				<?php endif ?>
				<!-- **************** Drivers' licenses END ******************** -->

				<!-- **************** Skills ******************** -->
				<?php if ($property == 'skill') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#demo6">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
								Skills</span>
						</div>
						<!-- data grid -->
						<div id="demo6" class="collapse hide main_info_items">
							<div class="container">
								<a href="persons/skills/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Skill description
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['skill_name'] ?>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>
				<?php endif ?>

				<!--  **************** Skills END ******************** -->

				<!-- **************** Languages ******************** -->
				<?php if ($property == 'language') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#demo2">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i><span class="prop-title">
								Languages</span>
						</div>
						<!-- data grid -->
						<div id="demo2" class="collapse hide">
							<div class="container">
								<a href="persons/languages/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Language
										</div>
										<div class="col">
											Level
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['language_name'] ?>
											</div>
											<div class="col details-grid">
												<?= $items['langlevel_code'] ?>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>
				<?php endif ?>
				<!-- **************** Languages END ******************** -->


				<!-- **************** Sectors ******************** -->
				<?php if ($property == 'sector') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#demo3">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
								Sectors</span>
						</div>
						<!-- data grid -->
						<div id="demo3" class="collapse hide">
							<div class="container">
								<a href="persons/sectors/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Description
										</div>
										<div class="col">
											Years of experience
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['sector'] ?>
											</div>
											<div class="col details-grid">
												<?= $items['sector_years'] ?></li>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>
				<?php endif ?>
				<!--  **************** Sectors END ******************** -->

				<!-- **************** Citizenships ******************** -->
				<?php if ($property == 'citizenship') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#demo4">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
								Citizenships</span>
						</div>
						<!-- data grid -->
						<div id="demo4" class="collapse hide">
							<div class="container">
								<a href="persons/citizenships/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['citizenship'] ?>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>
				<?php endif ?>
				<!--  **************** Citizenships END ******************** -->


				<!-- **************** Construction ******************** -->
				<?php if ($property == 'construction') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#demo5">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
								Construction
								experience</span>
						</div>
						<!-- data grid -->
						<div id="demo5" class="collapse hide">
							<div class="container">
								<a href="persons/construction/detail"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Construction works:
										</div>
									</div>

									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['construction_id'] ?>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>
				<?php endif ?>
				<!--  **************** Construction END ******************** -->

			<?php endforeach ?>
			<!-- END *** Show person's properties  *** -->


			<hr>

			<!-- start the desired job part -->
			<h2>Your Desired Job / Occupation is as Follows:</h2>


			<!-- ******************************************* -->
			<!-- ***  Main list of NOT found desires     *** -->
			<!-- ******************************************* -->
			<!-- if no driving data found -->
			<?php if (!array_key_exists('drivers_license', $desires)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/drivers_license/desire"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Drivers License</span>
					<p>

				</div>
			<?php endif ?>

			<!-- if no skills found -->
			<?php if (!array_key_exists('skill', $desires)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/skills/desire"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Skills</span>
					<p>
				</div>
			<?php endif ?>

			<!-- if no languages found -->
			<?php if (!array_key_exists('language', $desires)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/languages/desire"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Languages</span>
					<p>
				</div>
			<?php endif ?>

			<!-- if no sectors found -->
			<?php if (!array_key_exists('sector', $desires)) : ?>
				<div class="main_info_items">
					<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Data missing">
					<a href="persons/sectors/desire"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
					<span class="prop-title"> Sectors</span>
					<p>
				</div>
			<?php endif ?>



			<!-- ******************************************* -->
			<!-- ***     Main list of  found desires     *** -->
			<!-- ******************************************* -->
			<?php foreach ($desires as $property => $value) : ?>
				<!-- **************** Drivers' licenses ******************** -->
				<?php if ($property == 'drivers_license') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#des1">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
								Drivers'
								Licenses</span>
						</div>
						<!-- data grid -->
						<div id="des1" class="collapse hide">
							<div class="container">
								<a href="persons/drivers_license/desire"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Drivers' license type
										</div>
										<div class="col">
											Years of experience
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['drivers_license'] ?>
											</div>
											<div class="col details-grid">
												<?= $items['driving_years'] ?>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>

				<?php endif ?>
				<!-- **************** Drivers' licenses END ******************** -->

				<!-- **************** Skills ******************** -->
				<?php if ($property == 'skill') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#des2">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
								Skills</span>
						</div>
						<!-- data grid -->
						<div id="des2" class="collapse hide main_info_items">
							<div class="container">
								<a href="persons/skills/desire"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Skill description
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['skill_name'] ?>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>
				<?php endif ?>
				<!--  **************** Skills END ******************** -->

				<!-- **************** Languages ******************** -->
				<?php if ($property == 'language') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#des5">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i><span class="prop-title">
								Languages</span>
						</div>
						<!-- data grid -->
						<div id="des5" class="collapse hide">
							<div class="container">
								<a href="persons/languages/desire"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Language
										</div>
										<div class="col">
											Level
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['language_name'] ?>
											</div>
											<div class="col details-grid">
												<?= $items['langlevel_code'] ?>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>
				<?php endif ?>
				<!-- **************** Languages END ******************** -->


				<!-- **************** Sectors ******************** -->
				<?php if ($property == 'sector') : ?>
					<div class="main_info_items">
						<!-- header -->
						<div class="prop_dropdown" data-toggle="collapse" data-target="#des3">
							<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open"><i class="fa fa-plus"></i> <span class="prop-title">
								Sectors</span>
						</div>
						<!-- data grid -->
						<div id="des3" class="collapse hide">
							<div class="container">
								<a href="persons/sectors/desire"><img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit"></a>
								Details
								<div class="container">
									<div class="row">
										<div class="col">
											Description
										</div>
										<div class="col">
											Years of experience
										</div>
									</div>
									<?php foreach ($value as $items) : ?>
										<div class="row">
											<div class="col details-grid">
												<?= $items['sector'] ?>
											</div>
											<div class="col details-grid">
												<?= $items['sector_years'] ?></li>
											</div>
										</div>
									<?php endforeach ?>
								</div>
							</div>
						</div>
						<p>
					</div>
				<?php endif ?>
				<!--  **************** Sectors END ******************** -->

			<?php endforeach ?>
			<!-- ***     Main list of  found desires END    *** -->





			<!-- ******************************************* -->
			<!-- ***        Work hour preferences        *** -->
			<!-- ******************************************* -->
			<!-- use persons table -->
			<div class="main_info_items">

				<!-- header -->
				<div class="prop_dropdown" data-toggle="collapse" data-target="#des4">

					<?php if ($work_details['overtime'] === null || $work_details['nightshift'] === null || $work_details['other_shift'] === null) : ?>
						<img src=<?= base_url("/images/cancel_o_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Not set">
					<?php else : ?>
						<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Set">
					<?php endif ?>
					<i class="fa fa-plus"></i>
					<span class="prop-title">Overtime and work hour preferences</span>

				</div>
				<!-- data grid -->
				<div id="des4" class="collapse hide">
					<div class="card card-body">
						<?php include 'includes/admin_job_edit_workprefs_view.php'; ?>
					</div>
				</div>
			</div>
			<!--  **************** Work hour preferences END ******************** -->






			<hr>
			<h2>Your strengths, talents and hobbies</h2>
			<div class="prop_dropdown" data-toggle="collapse" data-target="#demo7">
				<i class="fa fa-plus"></i> Your strengths in school:<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open">
			</div>
			<div id="demo7" class="collapse hide">
				<a href="persons/school" class="text-muted">
					<img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit">
				</a>
				<ul>
					<li class="list-group-item">Technical subjects</li>
					<li class="list-group-item">Music</li>
					<li class="list-group-item">Physical Education</li>
					<li class="list-group-item">Maths</li>
				</ul>
			</div>

			<div class="prop_dropdown" data-toggle="collapse" data-target="#demo8">
				<i class="fa fa-plus"></i> Your current hobbies:<img src=<?= base_url("/images/confirm_b_s.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Open">
			</div>
			<div id="demo8" class="collapse hide">
				<a href="persons/school" class="text-muted">
					<img src=<?= base_url("/images/edit_s2.png") ?> class="beaicons" data-toggle="tooltip" data-placement="left" title="Edit">
				</a>
				<ul>
					<li class="list-group-item">Gaming</li>
					<li class="list-group-item">Sports
						<ul>
							<li class="list-group-item">Hiking</li>
							<li class="list-group-item">Cycling</li>
						</ul>
					</li>
					<li class="list-group-item">Software development
						<ul>
							<li class="list-group-item">Php</li>
							<li class="list-group-item">Mysql</li>
					</li>
				</ul>

				</ul>
			</div>

		<?php endif ?>
</div>


<?php include 'footer.php'; ?>