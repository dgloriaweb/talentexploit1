<?php include 'header.php';?>
<?php if (!$this->session->userdata('logged_in')): ?>

Welcome. You are not logged in.<br />

<!-- here we need to check if user is logged in -->
<?php else: ?>
<h1>
	<p style="text-transform: capitalize;">Skill: <?= $skill_data[0]->skill?></p>
</h1>
<div class="card" style="max-width: 30rem;">
	<?=form_open("admin_skills/update_skill"); ?>
	<div>
		<input type="text" id="skill_input" class="form-control" name="skill_input"
			value="<?= $skill_data[0]->skill ?>">
	</div>
	<div>
		<input type="hidden" id="skill_id" name="skill_id" value="<?= $skill_data[0]->skill_id ?>">
	</div>
	<div>
		<p><br>
			Skill type: <b><?= $skill_data[0]->skill_type ?></b>
		</p>
	</div>
	<div><button class="btn btn-warning">Save changes</button>
	<a href="<?= site_url('admin_skills') ?>" class="btn btn-secondary">Close</a>
	</div>
	<br>
	<?=form_close();?>
</div>
<div class="card" style="max-width: 20rem;">
	<h5>Core skill(s):</h5>


	<?php foreach($skill_data as $skill) : ?>
	<div>
		<a href="<?= site_url('admin_skills/remove_core_skill_link/'.$skill_data[0]->skill_id.'/'.$skill->core_skill_id) ?>">
			<img src=<?=base_url("images/trash_s.png")?> class="beaicons" data-toggle="tooltip" data-placement="right"
				title="Delete">
		</a>
		<?= $skill->core_skill?>
	</div>
	<?php endforeach ?>
	<br>

	<!-- add new core skill link using a modal with a dropdown -->
	<button class="btn btn-primary view_detail" relid="<?= $skill_data[0]->skill_id;  ?>">Add new core skill
		link</button>
	<a href="<?= site_url('admin_skills') ?>" class="btn btn-secondary">Close</a>
</div>


<!-- modal -->
<div id="show_modal" class="modal fade" role="dialog">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h3>Add Core skills</h3>
			</div>
			<?=form_open(site_url('admin_skills/add_core_skill_link/'.$skill_data[0]->skill_id));?>
			<div class="modal-body">
				<select class="form-control" id="core_skill_select" name="core_skill_selection">

				</select>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal"><i class="fa fa-times"></i>
					Close</button>
				<button type="submit" class="btn btn-success">Save changes</button>
			</div>
			<?=form_close();?>
		</div>
	</div>
</div>

<?php endif;?>



<!-- script for modal -->
<script type="text/javascript">
	$(document).ready(function () {
		$('.view_detail').click(function () {
			var id = $(this).attr('relid'); //get the attribute value
			$.ajax({
				url: "<?php echo base_url(); ?>admin_skills/get_core_skills_for_skill",
				data: {
					id: id
				},
				type: "post",
				// method: 'GET',
				dataType: 'json',
				success: function (response) {
					$.each(response, function (i) {
						$('#core_skill_select').append('<option value="' + response[i]
							.core_skill_id + '"> ' + response[i].core_skill +
							'</option>'); //hold the response in id and show on popup
					});
					$('#show_modal').modal({
						backdrop: 'static',
						keyboard: true,
						show: true
					});
				}
			});
		});
	});

</script>

</div>
<?php include 'footer.php'; ?>
